<?xml version="1.0" encoding="utf-8"?>
<Config manual_placement="true">
    <config_option function="true" parameter="true"/>
    <domain2_partition times="1" physical_space="[8, 8]"/>
    <node type = "paraset">
        <para name="{R}" default="31"/>   
        <para name="{C}" default="512"/>
        <para name="{INPUT_BASE}" default="40000"/>     
    </node>

<!-- R -->
<node type="pe" index="0" domain="0" opcode="lt" is_float="false" loop_control="loop" branch_control="null" self_loop="true" key_cal="false">
    <inner_connection
    buffer0_constant="true" buffer1_constant="true" buffer2_constant="true"
    buffer0_from="null" buffer1_from="null" buffer2_from="null"
    pick_initial="false" />
    <input type="null"/>
    <input type="null"/>
    <input type="null"/>
    <inbuffer value0="8" value1="0" value2="{R}"/><!-- step initial final -->
    <outbuffer value="0"/>
    <placement cord="[0, 8]"/>
</node>

<!-- C -->
<node type="pe" index="1" domain="0" opcode="lt" is_float="false" loop_control="loop" branch_control="null" self_loop="true" key_cal="false">
	<inner_connection
	buffer0_constant="true" buffer1_constant="true" buffer2_constant="true"
	buffer0_from="null" buffer1_from="null" buffer2_from="null"
	pick_initial="false" />
	<input type="null"/>
	<input type="null"/>
	<input type="null"/>
	<inbuffer value0="1" value1="0" value2="{C}"/>
	<!-- step initial final -->
	<outbuffer value="0"/>
	<placement cord="[0, 8]"/>
</node>
	
<!-- getmax -->
<node type="ag" index="0" domain="1" ag_mode="s2p" opcode="joint" buffer0_constant="true" buffer1_constant="false" buffer2_constant="true">
    <input type="null"/>
    <input type="pe" index="0" port="0"/><!-- get row -->
	<input type="pe" index="1" port="0"/>
    <inbuffer value0="0" value1="null" value2="null"/>
    <priority value="0"/>
    <direction value="row"/><!-- spatial expand dimension -->
    <stride value="1"/><!-- 空间展开每次+1 -->
    <times value="8" index="0_1_2_3_4_5_6_7"/><!-- 空间展开8次 -->
    <branch in0="null" in1="{R}" in2="null"/><!-- in1 get row，which should not exceed 31 -->
    <placement cord="[6, 10]"/>
</node>

<!-- input 8 -->
<node type="rdfifo" index="0" catalogue="a" access_inner="true" domain="2" size="1">
        <placement cord="[8, 2]"/>
</node>
<!-- input 9 -->
<node type="rdfifo" index="1" catalogue="a" access_inner="true" domain="2" size="1">
        <placement cord="[8, 4]"/>
</node>
<!-- input 10 -->
<node type="rdfifo" index="2" catalogue="a" access_inner="true" domain="2" size="1">
        <placement cord="[8, 6]"/>
</node>
<!-- input 11 -->
<node type="rdfifo" index="3" catalogue="a" access_inner="true" domain="2" size="1">
        <placement cord="[8, 8]"/>
</node>
<!-- input 12 -->
<node type="rdfifo" index="4" catalogue="a" access_inner="true" domain="2" size="1">
        <placement cord="[8, 10]"/>
</node>
<!-- input 13 -->
<node type="rdfifo" index="5" catalogue="a" access_inner="true" domain="2" size="1">
        <placement cord="[8, 12]"/>
</node>
<!-- input 14 -->
<node type="rdfifo" index="6" catalogue="a" access_inner="true" domain="2" size="1">
        <placement cord="[8, 14]"/>
</node>
<!-- input 15 -->
<node type="rdfifo" index="7" catalogue="a" access_inner="true" domain="2" size="1">
        <placement cord="[8, 16]"/>
</node>

<!-- add 0 --> <!-- transout表示是否要累加/累乘，null表示是否直接算完就行 --> 
<node type="pe" index="2" domain="2" opcode="sadd" is_float="false" loop_control="null" branch_control="null" self_loop="false"  key_cal="true" partition_times="1st">
    <inner_connection
    buffer0_constant="false" buffer1_constant="true" buffer2_constant="false"
    buffer0_from="in0" buffer1_from="null" buffer2_from="null"
    pick_initial="false"/>
    <input type="rdfifo" index="0" port="0"/>
    <input type="null"/>
    <input type="null"/>
    <inbuffer value0="null" value1="0" value2="null"/>
    <outbuffer value="null"/>
    <placement cord="[12, 2]"/>
</node>
<!-- add 1 --> 
<node type="pe" index="3" domain="2" opcode="sadd" is_float="false" loop_control="null" branch_control="null" self_loop="false"  key_cal="true" partition_times="1st">
    <inner_connection
    buffer0_constant="false" buffer1_constant="true" buffer2_constant="false"
    buffer0_from="in0" buffer1_from="null" buffer2_from="null"
    pick_initial="false"/>
    <input type="rdfifo" index="1" port="0"/>
    <input type="null"/>
    <input type="null"/>
    <inbuffer value0="null" value1="0" value2="null"/>
    <outbuffer value="null"/>
    <placement cord="[12, 4]"/>
</node>
<!-- add 2 --> 
<node type="pe" index="4" domain="2" opcode="sadd" is_float="false" loop_control="null" branch_control="null" self_loop="false"  key_cal="true" partition_times="1st">
    <inner_connection
    buffer0_constant="false" buffer1_constant="true" buffer2_constant="false"
    buffer0_from="in0" buffer1_from="null" buffer2_from="null"
    pick_initial="false"/>
    <input type="rdfifo" index="2" port="0"/>
    <input type="null"/>
    <input type="null"/>
    <inbuffer value0="null" value1="0" value2="null"/>
    <outbuffer value="null"/>
    <placement cord="[12, 6]"/>
</node>
<!-- add 3 --> 
<node type="pe" index="5" domain="2" opcode="sadd" is_float="false" loop_control="null" branch_control="null" self_loop="false"  key_cal="true" partition_times="1st">
    <inner_connection
    buffer0_constant="false" buffer1_constant="true" buffer2_constant="false"
    buffer0_from="in0" buffer1_from="null" buffer2_from="null"
    pick_initial="false"/>
    <input type="rdfifo" index="3" port="0"/>
    <input type="null"/>
    <input type="null"/>
    <inbuffer value0="null" value1="0" value2="null"/>
    <outbuffer value="null"/>
    <placement cord="[12, 8]"/>
</node>
<!-- add 4 --> 
<node type="pe" index="6" domain="2" opcode="sadd" is_float="false" loop_control="null" branch_control="null" self_loop="false"  key_cal="true" partition_times="1st">
    <inner_connection
    buffer0_constant="false" buffer1_constant="true" buffer2_constant="false"
    buffer0_from="in0" buffer1_from="null" buffer2_from="null"
    pick_initial="false"/>
    <input type="rdfifo" index="4" port="0"/>
    <input type="null"/>
    <input type="null"/>
    <inbuffer value0="null" value1="0" value2="null"/>
    <outbuffer value="null"/>
    <placement cord="[12, 10]"/>
</node>
<!-- add 5 --> 
<node type="pe" index="7" domain="2" opcode="sadd" is_float="false" loop_control="null" branch_control="null" self_loop="false"  key_cal="true" partition_times="1st">
    <inner_connection
    buffer0_constant="false" buffer1_constant="true" buffer2_constant="false"
    buffer0_from="in0" buffer1_from="null" buffer2_from="null"
    pick_initial="false"/>
    <input type="rdfifo" index="5" port="0"/>
    <input type="null"/>
    <input type="null"/>
    <inbuffer value0="null" value1="0" value2="null"/>
    <outbuffer value="null"/>
    <placement cord="[12, 12]"/>
</node>
<!-- add 6 --> 
<node type="pe" index="8" domain="2" opcode="sadd" is_float="false" loop_control="null" branch_control="null" self_loop="false"  key_cal="true" partition_times="1st">
    <inner_connection
    buffer0_constant="false" buffer1_constant="true" buffer2_constant="false"
    buffer0_from="in0" buffer1_from="null" buffer2_from="null"
    pick_initial="false"/>
    <input type="rdfifo" index="6" port="0"/>
    <input type="null"/>
    <input type="null"/>
    <inbuffer value0="null" value1="0" value2="null"/>
    <outbuffer value="null"/>
    <placement cord="[12, 14]"/>
</node>
<!-- add 7 --> 
<node type="pe" index="9" domain="2" opcode="sadd" is_float="false" loop_control="null" branch_control="null" self_loop="false"  key_cal="true" partition_times="1st">
    <inner_connection
    buffer0_constant="false" buffer1_constant="true" buffer2_constant="false"
    buffer0_from="in0" buffer1_from="null" buffer2_from="null"
    pick_initial="false"/>
    <input type="rdfifo" index="7" port="0"/>
    <input type="null"/>
    <input type="null"/>
    <inbuffer value0="null" value1="0" value2="null"/>
    <outbuffer value="null"/>
    <placement cord="[12, 16]"/>
</node>


<!-- output AG -->
<node type="ag" index="1" domain="1" ag_mode="p2s" opcode="joint" buffer0_constant="true" buffer1_constant="false" buffer2_constant="true">
    <input type="null"/>
    <input type="pe" index="0" port="0"/>
    <input type="null"/>
    <inbuffer value0="0" value1="null" value2="0"/>
    <priority value="0"/>
    <direction value="row"/>
    <stride value="1"/>
    <times value="8" index="0_1_2_3_4_5_6_7"/>
    <branch in0="null" in1="{R}" in2="null"/>
    <placement cord="[6, 8]"/>
</node>

<node type="wrfifo" opcode="rec" index="0"  access_inner="true" domain="2" size="2">
        <input type="pe" index="2" port="0"/>
        <placement cord="[30, 2]"/>
</node>
<node type="wrfifo" opcode="rec" index="1"  access_inner="true" domain="2" size="2">
        <input type="pe" index="3" port="0"/>
        <placement cord="[30, 4]"/>
</node>
<node type="wrfifo" opcode="rec" index="2"  access_inner="true" domain="2" size="2">
        <input type="pe" index="4" port="0"/>
        <placement cord="[30, 6]"/>
</node>
<node type="wrfifo" opcode="rec" index="3"  access_inner="true" domain="2" size="2">
        <input type="pe" index="5" port="0"/>
        <placement cord="[30, 8]"/>
</node>
<node type="wrfifo" opcode="rec" index="4"  access_inner="true" domain="2" size="2">
        <input type="pe" index="6" port="0"/>
        <placement cord="[30, 10]"/>
</node>
<node type="wrfifo" opcode="rec" index="5"  access_inner="true" domain="2" size="2">
        <input type="pe" index="7" port="0"/>
        <placement cord="[30, 12]"/>
</node>
<node type="wrfifo" opcode="rec" index="6"  access_inner="true" domain="2" size="2">
        <input type="pe" index="8" port="0"/>
        <placement cord="[30, 14]"/>
</node>
<node type="wrfifo" opcode="rec" index="7"  access_inner="true" domain="2" size="2">
        <input type="pe" index="9" port="0"/>
        <placement cord="[30, 16]"/>
</node>



<node type="lsu" index="0">
        <prefetch ddr_base_addr="{INPUT_BASE}" local_base_addr="0" prefetch_times="{R}" prefetch_stide="0" prefetch_cnt="1" is_spm="true" stream_index="0"/>
        <writeback ddr_base_addr="{INPUT_BASE}" local_base_addr="0" write_times="{R}" write_stide="0" write_cnt="1" is_spm="true" stream_index="1"/>
        <placement cord="[0, 0]"/>
</node>

<node type="scratchpad" index="0">
        <stream stream_index="0" mode="rd" pattern="5" pow2_mode="false" local_row="{R}*{C}/32" local_col="0" multi="1"   stride="1"  N="32"  delta="0_1_2_3_4_5_6_7_8_9_10_11_12_13_14_15" />
        <stream stream_index="1" mode="wr" pattern="5" pow2_mode="false" local_row="{R}*{C}/32" local_col="0" multi="1"   stride="1"  N="32"  delta="0_1_2_3_4_5_6_7_8_9_10_11_12_13_14_15" />
        <placement cord="[0, 0]"/>
</node>

<node type="bus" index="0" level="0" end_table="wrfifo.0.0_wrfifo.1.0_wrfifo.2.0_wrfifo.3.0_wrfifo.4.0_wrfifo.5.0_wrfifo.6.0_wrfifo.7.0">
        <placement cord="[0, 0]"/>
</node>

</Config>